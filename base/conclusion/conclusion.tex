\section{Future directions}

TDA has proven a useful addition to the population geneticist's toolbox. The work done in this thesis has been on genotypic data, and usually using the top principal components for computational reasons. Since the publication of the manuscripts, multi-threaded versions of UMAP and HDBSCAN($\hat{\epsilon}$) have been released. One avenue for future research is to work directly with genotype data that has not been processed with PCA. We explored this briefly in \hyperref[chap:chapter1]{Chapter~1} using 1KGP data; the improvement in compute time with multi-threading should make deeper investigation more feasible.

There are possible connections between genetic topology and IBD. As noted in \hyperref[chap:chapter3]{Chapter~3}, UMAP and HDBSCAN($\hat{\epsilon}$) extract population structure that appears similar in scale to IBD studies of diverse biobanks; the two methods may capture similar information but via different routes. Clusters extracted by our TDA approach likely contain substructure themselves, and a clustering approach that breaks clusters down further may reveal finer details.

Studying different subsets of populations or genetic data may be illuminating. We have noted studies in \hyperref[chap:chapter2]{Chapter~2} that use, e.g., structural variants rather than genotype data. Sex-bias in admixture has been noted in other studies (e.g. \citep{ongaro_evaluating_2021,korunes_sex-biased_2022,marcheco-teruel_cuba_2014}), whereas all of the analyses presented here have been on autosomal data and combining the sexes. Each of these approaches seems likely to uncover interesting patterns.

Within the biomedical realm, the confounding of GWAS and transferability of PGS are perennial areas of research. We presented a method of visualization in \hyperref[chap:chapter3]{Chapter~3} that illustrates how PCA adjustment affects populations across an entire biobank, with an additional analysis that studied the transferability of PGS. These approaches could also extend to studying the interplay between environment, genetics, and biomedical traits.

\section{Final conclusion}
This thesis has introduced a TDA methodology for high-dimensional population genetic data, applying UMAP and HDBSCAN($\hat{\epsilon}$) to several biobanks. In \hyperref[chap:chapter1]{Chapter~1} we applied UMAP to population genetic data for the first time, using it for visualization and revealing fine-scale population structure on data sets of up to half a million individuals. We illustrated its potential for exploratory analyses with examples of many applications; it is now a standard method in the field. In \hyperref[chap:chapter2]{Chapter~2}, we review the uses of UMAP in population genetics, discuss the impacts of data filtering and parametrization, and provide guidance on best practices. Finally, in \hyperref[chap:chapter3]{Chapter~3}, we provide a method to reliably extract clusters in UMAP data. We use these clusters to stratify biobank data, characterize population structure in terms of clusters, carry out quality control, study the impacts of PCA correction in GWAS and PGS and the transferability of PGS between different populations, and highlight genetic variants that may transfer between groups. In each chapter, we expound upon the relationships between UMAP data, clusters, and auxiliary data such as population labels, distributions of phenotypes, the geographic distribution of genetic variation, and demographic history. In each case, we have also made our code and data publicly available. 

In conclusion, this thesis has established a rich basis for deep exploration of biobank data---a method that is fast, tractable, and creates compelling visualizations that encourage investigation.

\clearpage


